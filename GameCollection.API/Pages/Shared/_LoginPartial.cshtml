@* Pages/Shared/_LoginPartial.cshtml *@
@using System.Security.Claims
@inject IHttpContextAccessor HttpContextAccessor

@{
    var isAuthenticated = User?.Identity?.IsAuthenticated ?? false;
    var username = User?.FindFirst(ClaimTypes.Name)?.Value;
}

@if (isAuthenticated)
{
    <!-- Authenticated User Menu -->
    <div class="dropdown">
        <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle"
           data-bs-toggle="dropdown" aria-expanded="false">
            <div class="me-2">
                <div class="avatar-circle bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center"
                     style="width: 32px; height: 32px; font-size: 0.9rem;">
                    @if (!string.IsNullOrEmpty(username))
                    {
                        @username.Substring(0, 1).ToUpper()
                    }
                </div>
            </div>
            <div class="d-none d-md-block">
                <div class="small fw-bold">@username</div>
                <div class="small text-muted">My Account</div>
            </div>
        </a>
        <ul class="dropdown-menu dropdown-menu-end">
            <li>
                <a class="dropdown-item" href="/Account/Profile">
                    <i class="bi bi-person me-2"></i>My Profile
                </a>
            </li>
            <li>
                <a class="dropdown-item" href="/Collections">
                    <i class="bi bi-collection me-2"></i>My Collections
                </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
                <a class="dropdown-item" href="/Games/Create">
                    <i class="bi bi-plus-circle me-2"></i>Add New Game
                </a>
            </li>
            <li>
                <a class="dropdown-item" href="/Collections/Create">
                    <i class="bi bi-folder-plus me-2"></i>Create Collection
                </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
                <form method="post" asp-page="/Account/Logout" class="mb-0">
                    <button type="submit" class="dropdown-item text-danger">
                        <i class="bi bi-box-arrow-right me-2"></i>Logout
                    </button>
                </form>
            </li>
        </ul>
    </div>
}
else
{
    <!-- Guest User Menu -->
    <div class="d-flex align-items-center gap-2">
        <a asp-page="/Account/Login" asp-route-returnUrl="@Context.Request.Path"
           class="btn btn-outline-primary btn-sm">
            <i class="bi bi-box-arrow-in-right me-1"></i>Login
        </a>
        <a asp-page="/Account/Register" asp-route-returnUrl="@Context.Request.Path"
           class="btn btn-primary btn-sm">
            <i class="bi bi-person-plus me-1"></i>Register
        </a>
    </div>
}

<style>
    .avatar-circle {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
</style>